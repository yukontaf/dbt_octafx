{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.12", "generated_at": "2024-04-19T15:02:41.938119Z", "invocation_id": "ffc78d29-e2e4-4778-8e96-056faeac6f04", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:23.885940Z", "completed_at": "2024-04-19T15:02:23.890186Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:23.910143Z", "completed_at": "2024-04-19T15:02:25.444250Z"}], "thread_id": "Thread-4", "execution_time": 1.5782859325408936, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "3f487900-b519-460a-ad44-10c60eb77bda", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.funnel_bloomreach_events", "compiled": true, "compiled_code": "\n\nSELECT\n  action_id,\n  properties.action_name,\n  properties.action_type,\n  campaign_id,\n  event_number,\n  properties.platform,\n  properties.status,\n  timestamp,\n  user_id,\n  properties.variant\nFROM\n  (\n    SELECT\n      *,\n      ROW_NUMBER() OVER (\n        PARTITION BY user_id\n        ORDER BY\n          timestamp ASC\n      ) AS event_number\n    FROM\n      `analytics-147612`.`bloomreach_raw`.`campaign`\n    WHERE\n      timestamp >= '2024-04-01' and \n      properties.action_type in ('mobile notification', 'email', 'split')\n  ) AS bloomreach_events\nGROUP BY\n  action_id,\n  properties.action_name,\n  properties.action_type,\n  campaign_id,\n  event_number,\n  properties.platform,\n  properties.status,\n  timestamp,\n  user_id,\n  properties.variant", "relation_name": "`analytics-147612`.`dev_gsokolov`.`funnel_bloomreach_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:23.868548Z", "completed_at": "2024-04-19T15:02:23.889395Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:23.890883Z", "completed_at": "2024-04-19T15:02:25.555820Z"}], "thread_id": "Thread-1", "execution_time": 1.6918082237243652, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "4b421be1-cfd5-4700-8884-d000b9c7eb0c", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.ab_users", "compiled": true, "compiled_code": "WITH\neligible AS (\n    SELECT\n        properties.variant AS variant,\n        SAFE_CAST(user_id AS INT64) AS user_id\n    FROM `analytics-147612`.`bloomreach_raw`.`campaign`\n    WHERE\n        campaign_id = \"65733b51df03a1daadeb772d\"\n        AND action_id = 437\n)\n\nSELECT\n    user_id,\n    variant\nFROM eligible\n", "relation_name": "`analytics-147612`.`dev_gsokolov`.`ab_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:23.877789Z", "completed_at": "2024-04-19T15:02:23.890531Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:23.912644Z", "completed_at": "2024-04-19T15:02:25.727484Z"}], "thread_id": "Thread-2", "execution_time": 1.8628497123718262, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "fd032b0c-3e6c-4432-9493-97f402a20800", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.appsflyer_uninstall_events_report", "compiled": true, "compiled_code": "with source as (\n\n    select * from `analytics-147612`.`wh_raw`.`appsflyer_uninstall_events_report`\n\n),\n\nrenamed as (\n\n    select\n        install_time,\n        event_time,\n        event_value,\n        campaign,\n        campaign_id,\n        region,\n        country_code,\n        appsflyer_id,\n        customer_user_id,\n        platform,\n        os_version,\n        app_version,\n        sdk_version,\n        app_id,\n        app_name,\n        bundle_id,\n        user_agent,\n        google_play_referrer,\n        google_play_click_time,\n        google_play_install_begin_time\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`analytics-147612`.`dev_gsokolov`.`appsflyer_uninstall_events_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:25.447571Z", "completed_at": "2024-04-19T15:02:25.451107Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:25.451644Z", "completed_at": "2024-04-19T15:02:27.313409Z"}], "thread_id": "Thread-4", "execution_time": 1.867805004119873, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "5d88aa0f-fe95-44af-9ef2-ac26ed43be27", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.funnel_deals", "compiled": true, "compiled_code": "\n\nSELECT\n    user_id\n    , cmd\n    , open_time_dt AS timestamp\n    , symbol_name\nFROM `analytics-147612`.`wh_raw`.`trading_real_raw`\nWHERE open_time_dt >= TIMESTAMP_TRUNC(TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY), MONTH)\n    AND open_time_dt < TIMESTAMP_TRUNC(CURRENT_TIMESTAMP(), DAY) and cmd < 2\n    and symbol_name = 'XAUUSD'\nGROUP BY user_id, cmd, timestamp, symbol_name", "relation_name": "`analytics-147612`.`dev_gsokolov`.`funnel_deals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:25.731095Z", "completed_at": "2024-04-19T15:02:25.734885Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:25.735617Z", "completed_at": "2024-04-19T15:02:27.468355Z"}], "thread_id": "Thread-2", "execution_time": 1.738692045211792, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "25eb627d-cbf3-4a60-9092-1e1aa3b0c4aa", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_af_events", "compiled": true, "compiled_code": "SELECT\n    af.id,\n    af.appsflyer_id\n    -- , af_id.user_id\n    , media_source\n    , af_channel\n    , campaign\n    , country_code\n    , af.ip\n    , af.platform\n    , af.device_type\n    , af.os_version\n    , af.app_version\n    , af.sdk_version\n    , af.app_id\n    , af.app_name\n    , af.bundle_id\n    , af.event_name\n    , af.event_value\n    , af.device_model\n    , af.device_brand\n    , af.event_type\n    , af.event_time_dt\n    , af.install_time_dt\n    , af.store_reinstall\n    , af.install_app_store\nFROM `analytics-147612`.`wh_raw`.`mobile_appsflyer` AS af\nWHERE af.event_time_dt >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_af_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:23.880255Z", "completed_at": "2024-04-19T15:02:23.896759Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:23.915073Z", "completed_at": "2024-04-19T15:02:27.720534Z"}], "thread_id": "Thread-3", "execution_time": 3.8551690578460693, "adapter_response": {"_message": "CREATE TABLE (257.0 rows, 10.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 257, "bytes_processed": 11188, "bytes_billed": 20971520, "location": "EU", "project_id": "analytics-147612", "job_id": "7173437a-1f2c-4842-bcc7-fa3b09fb209d", "slot_ms": 3269}, "message": "CREATE TABLE (257.0 rows, 10.9 KiB processed)", "failures": null, "unique_id": "model.dbt_octafx.countries", "compiled": true, "compiled_code": "\n\nSELECT\n    c.country,\n    c.code,\n    ct.tier,\n    concat(\"Tier \", ct.tier_id) as tier_name\nFROM `analytics-147612`.`wh_raw`.`countries` AS c\nLEFT JOIN\n    `analytics-147612`.`wh_raw`.`countries_tiers` AS ct\n    ON c.country = ct.country", "relation_name": "`analytics-147612`.`dev_gsokolov`.`countries`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:27.471516Z", "completed_at": "2024-04-19T15:02:27.474883Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:27.475605Z", "completed_at": "2024-04-19T15:02:28.898327Z"}], "thread_id": "Thread-2", "execution_time": 1.429718017578125, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d3d0471f-23bb-46e4-ba6b-46413f7960c5", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_users", "compiled": true, "compiled_code": "select\n    user_id,\n    country_code,\n    registered_dt\nfrom\n    `analytics-147612`.`wh_raw`.`users`\nwhere registered_dt >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:27.317045Z", "completed_at": "2024-04-19T15:02:27.320844Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:27.321436Z", "completed_at": "2024-04-19T15:02:28.917885Z"}], "thread_id": "Thread-4", "execution_time": 1.6093590259552002, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d8f493c7-97d2-4e08-88a7-d0aa8c837e7e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_bloomreach_events", "compiled": true, "compiled_code": "\n\nselect\n    c.type,\n    c.ingest_timestamp,\n    c.timestamp,\n    properties.action_type,\n    properties.campaign_trigger,\n    properties.language,\n    properties.platform,\n    properties.campaign_name,\n    properties.action_id,\n    properties.campaign_policy,\n    -- properties.subject,\n    properties.action_name,\n    properties.recipient,\n    -- properties.message,\n    properties.sent_timestamp,\n    properties.consent_category,\n    properties.campaign_id,\n    properties.status,\n    properties.integration_id,\n    properties.message_id,\n    properties.integration_name,\n    properties.utm_campaign,\n    properties.utm_medium,\n    properties.utm_source,\n    properties.code,\n    properties.message_type,\n    properties.sender,\n    properties.sending_ip,\n    properties.country,\n    properties.city,\n    properties.ip,\n    properties.state,\n    properties.longitude,\n    properties.status_code,\n    properties.error,\n    properties.event_type,\n    properties.symbol,\n    properties.redirect_to_screen,\n    properties.template_name,\n    properties.title,\n    properties.attempts,\n    properties.delta_time,\n    properties.os,\n    properties.location,\n    properties.device,\n    properties.action_url,\n    safe_cast(c.user_id as numeric) as user_id\nfrom `analytics-147612`.`bloomreach_raw`.`campaign` as c\nwhere\n    timestamp_trunc(c.timestamp, day) >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:27.723997Z", "completed_at": "2024-04-19T15:02:27.727049Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:27.727595Z", "completed_at": "2024-04-19T15:02:29.142970Z"}], "thread_id": "Thread-3", "execution_time": 1.4204730987548828, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "8b06e3dd-5b41-4d77-b51b-54a85ea27113", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.users_cids_all", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from `analytics-147612`.`wh_raw`.`users_cids_all`\n\n),\n\nrenamed as (\n\n    select\n        client_id,\n        user_id,\n        dt,\n        src_info\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`analytics-147612`.`dev_gsokolov`.`users_cids_all`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:29.146201Z", "completed_at": "2024-04-19T15:02:29.149496Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:29.150063Z", "completed_at": "2024-04-19T15:02:30.887834Z"}], "thread_id": "Thread-3", "execution_time": 1.7429680824279785, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "4d3155cb-72a2-4c9d-bbb4-1913e771ba03", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.user_deals", "compiled": true, "compiled_code": "SELECT \n    u.user_id,\n    u.variant,\n    COALESCE(t.operation_id, 0) AS operation_id,\n    COALESCE(t.symbol_name, '') AS symbol_name,\n    COALESCE(t.cmd, 0) AS cmd,\n    COALESCE(t.volume, 0) AS volume,\n    COALESCE(t.open_price, 0) AS open_price,\n    COALESCE(t.close_price, 0) AS close_price,\n    COALESCE(t.profit, 0) AS profit,\n    COALESCE(t.open_time_dt, CAST('1970-01-01' AS TIMESTAMP)) AS open_time_dt,\n    COALESCE(t.close_time_dt, CAST('1970-01-01' AS TIMESTAMP)) AS close_time_dt,\n    COALESCE(DATE(DATE_TRUNC(t.open_time_dt, DAY)), DATE('1970-01-01')) AS trade_day\nFROM \n    `analytics-147612`.`dev_gsokolov`.`ab_users` u\n    LEFT JOIN `analytics-147612`.`wh_raw`.`trading_real_raw` AS t ON u.user_id = t.user_id\n        AND (DATE(t.open_time_dt) BETWEEN '2024-04-02' AND '2024-04-09')\n        AND (DATE(t.close_time_dt) BETWEEN '2024-04-02' AND '2024-04-09')\n        AND t.cmd < 2", "relation_name": "`analytics-147612`.`dev_gsokolov`.`user_deals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:25.558923Z", "completed_at": "2024-04-19T15:02:28.067106Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:28.067812Z", "completed_at": "2024-04-19T15:02:32.294023Z"}], "thread_id": "Thread-1", "execution_time": 6.737820863723755, "adapter_response": {"_message": "CREATE TABLE (11.0k rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 10958, "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d5e21202-f14c-48d5-8fc1-3e37d9556533", "slot_ms": 64359}, "message": "CREATE TABLE (11.0k rows, 0 processed)", "failures": null, "unique_id": "model.dbt_octafx.metricflow_time_spine", "compiled": true, "compiled_code": "-- filename: metricflow_time_spine.sql\n-- BigQuery supports DATE() instead of TO_DATE(). Use this model if you're using BigQuery\n\nwith days as (\n    \n\n\n    \n\n\n    with rawdata as (\n\n        \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n     + \n    \n    p13.generated_number * power(2, 13)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n     cross join \n    \n    p as p13\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 10958\n    order by generated_number\n\n\n\n    ),\n\n    all_periods as (\n\n        select (\n            \n\n        datetime_add(\n            cast( DATE(2000,01,01) as datetime),\n        interval row_number() over (order by 1) - 1 day\n        )\n\n\n        ) as date_day\n        from rawdata\n\n    ),\n\n    filtered as (\n\n        select *\n        from all_periods\n        where date_day <= DATE(2030,01,01)\n\n    )\n\n    select * from filtered\n\n\n),\n\nfinal as (\n    select cast(date_day as date) as date_day\n    from days\n)\n\nselect *\nfrom final", "relation_name": "`analytics-147612`.`dev_gsokolov`.`metricflow_time_spine`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:30.892875Z", "completed_at": "2024-04-19T15:02:30.896122Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:30.896656Z", "completed_at": "2024-04-19T15:02:32.525883Z"}], "thread_id": "Thread-3", "execution_time": 1.636486291885376, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d86dbf36-e3c0-48ff-842f-95921483a8a6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.event_stream", "compiled": true, "compiled_code": "\n\n\n\n\nWITH bloomreach_events AS (\n    SELECT\n        action_type AS event_type,\n        timestamp,\n        cast(user_id as int) user_id,\n        'communication' AS event_nature\n    FROM\n        `analytics-147612`.`dev_gsokolov`.`funnel_bloomreach_events`\n    WHERE\n        timestamp >= '2024-04-01' AND\n        timestamp <= '2024-04-10'\n),\n\ndeals AS (\n    SELECT\n        cast(cmd as string) AS event_type,\n        timestamp,\n        user_id,\n        'deal' AS event_nature\n    FROM\n        `analytics-147612`.`dev_gsokolov`.`funnel_deals`\n    WHERE\n        timestamp >= '2024-04-01' AND\n        timestamp <= '2024-04-10'\n)\n\nSELECT * FROM bloomreach_events\nUNION ALL\nSELECT * FROM deals\nORDER BY user_id, timestamp", "relation_name": "`analytics-147612`.`dev_gsokolov`.`event_stream`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:32.298626Z", "completed_at": "2024-04-19T15:02:32.301757Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:32.302392Z", "completed_at": "2024-04-19T15:02:33.999991Z"}], "thread_id": "Thread-1", "execution_time": 1.7035291194915771, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "dbcec9e1-c0d1-4490-806b-6601e58e4e85", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_bloomreach_events_enhanced", "compiled": true, "compiled_code": "select\n    c.*,\n    u.country_code,\n    u.registered_dt\nfrom `analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events` as c\ninner join `analytics-147612`.`dev_gsokolov`.`stg_users` as u\n    on\n        safe_cast(c.user_id as integer) = u.user_id\n        and timestamp_trunc(\n            c.timestamp, day\n        ) between u.registered_dt and u.registered_dt\n        + interval 28 day", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:32.530530Z", "completed_at": "2024-04-19T15:02:32.533574Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:32.534252Z", "completed_at": "2024-04-19T15:02:34.154697Z"}], "thread_id": "Thread-3", "execution_time": 1.6271193027496338, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "09783b48-0805-4a66-afd7-1aeb7e39589d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_pushes", "compiled": true, "compiled_code": "select ue.*\nfrom `analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events` as ue\nwhere action_type = 'mobile notification'\nand status in ('delivered', 'clicked', 'failed')", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_pushes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:29.026173Z", "completed_at": "2024-04-19T15:02:29.026175Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:29.026656Z", "completed_at": "2024-04-19T15:02:35.159581Z"}], "thread_id": "Thread-4", "execution_time": 6.135090112686157, "adapter_response": {"_message": "INSERT 4855", "code": "INSERT", "rows_affected": 4855}, "message": "INSERT 4855", "failures": null, "unique_id": "seed.dbt_octafx.XNGUSD_random", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:28.904970Z", "completed_at": "2024-04-19T15:02:28.904973Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:28.905980Z", "completed_at": "2024-04-19T15:02:35.214066Z"}], "thread_id": "Thread-2", "execution_time": 6.311383008956909, "adapter_response": {"_message": "INSERT 8596", "code": "INSERT", "rows_affected": 8596}, "message": "INSERT 8596", "failures": null, "unique_id": "seed.dbt_octafx.ETHUSD_random", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:34.161978Z", "completed_at": "2024-04-19T15:02:34.168866Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:34.169697Z", "completed_at": "2024-04-19T15:02:35.922513Z"}], "thread_id": "Thread-3", "execution_time": 1.7634077072143555, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "0577e6a8-3ee8-446a-b2f1-4ffc245d0150", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.ab_stats", "compiled": true, "compiled_code": "WITH stats AS (\n    SELECT\n        user_id,\n        variant,\n        COUNT(DISTINCT operation_id) AS deals_cnt,\n        COALESCE(SUM(volume), 0) AS symbol_volume,\n        COALESCE(\n            SUM(\n                CASE\n                    WHEN\n                        symbol_name = 'XAUUSD'\n                        THEN volume ELSE\n                        0\n                END\n            ),\n            0\n        ) AS XAUUSD_vol,\n        MIN(\n            CASE\n                WHEN symbol_name = 'XAUUSD' THEN open_time_dt\n            END\n        )\n            AS first_XAUUSD_deal,\n        COALESCE(\n            SUM(\n                CASE\n                    WHEN symbol_name = 'XAUUSD' THEN 1 ELSE 0\n                END\n            ),\n            0\n        )\n            AS XAUUSD_deals_cnt,\n        IF(\n            COALESCE(\n                SUM(\n                    CASE\n                        WHEN\n                            symbol_name = 'XAUUSD'\n                            THEN 1 ELSE\n                            0\n                    END\n                ),\n                0\n            )\n            > 0,\n            1,\n            0\n        ) AS XAUUSD_converted\n    FROM\n        `analytics-147612`.`dev_gsokolov`.`user_deals`\n    GROUP BY\n        user_id, variant\n)\n\nSELECT\n    user_id,\n    variant,\n    deals_cnt,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY deals_cnt)\n        AS deals_cnt_percentile,\n    symbol_volume,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY symbol_volume)\n        AS symbol_volume_percentile,\n    XAUUSD_vol,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY XAUUSD_vol)\n        AS XAUUSD_vol_percentile,\n    COALESCE(CAST(first_XAUUSD_deal AS STRING), 'N/A')\n        AS first_XAUUSD_deal,\n    XAUUSD_deals_cnt,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY XAUUSD_deals_cnt)\n        AS XAUUSD_deals_cnt_percentile,\n    XAUUSD_converted\nFROM\n    stats\nORDER BY\n    deals_cnt DESC", "relation_name": "`analytics-147612`.`dev_gsokolov`.`ab_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:35.162840Z", "completed_at": "2024-04-19T15:02:35.173864Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:35.174438Z", "completed_at": "2024-04-19T15:02:36.859676Z"}], "thread_id": "Thread-4", "execution_time": 1.6982250213623047, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "faf71cff-bf29-41d2-b0a2-a877a90a19d4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.funnel_dbt", "compiled": true, "compiled_code": "\n\n\n\n\n  with event_stream as (  \n  select event_nature as event_type, user_id as user_id, timestamp as event_date\n  from `analytics-147612`.`dev_gsokolov`.`event_stream`\n  where 1 = 1\n  \n  \n\n    \n    \n    \n   )\n  \n    , event_stream_step_1 as (\n      select event_stream.* \n      from event_stream\n      \n      where event_stream.event_type = 'communication'\n    )\n\n    , step_1 as (\n      select count(distinct user_id) as unique_users \n      from event_stream_step_1\n    )  \n\n  \n    , event_stream_step_2 as (\n      select event_stream.* \n      from event_stream\n      \n        inner join event_stream_step_1 as previous_events\n          on event_stream.user_id = previous_events.user_id\n          and previous_events.event_type = 'communication'\n          and previous_events.event_date <= event_stream.event_date\n      \n      where event_stream.event_type = 'deal'\n    )\n\n    , step_2 as (\n      select count(distinct user_id) as unique_users \n      from event_stream_step_2\n    )  \n\n  \n\n  , event_funnel as (\n    \n      select 'communication' as event_type, unique_users, 1 as step_index\n      from step_1\n      \n        union all\n      \n    \n      select 'deal' as event_type, unique_users, 2 as step_index\n      from step_2\n      \n    \n  )\n\n  , final as (\n    select event_type\n      , unique_users, 1.0 * unique_users / nullif(first_value(unique_users) over(order by step_index), 0) as pct_conversion\n      , 1.0 * unique_users / nullif(lag(unique_users) over(order by step_index), 0) as pct_of_previous\n    from event_funnel\n  )\n\n  select * from final\n", "relation_name": "`analytics-147612`.`dev_gsokolov`.`funnel_dbt`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:35.217173Z", "completed_at": "2024-04-19T15:02:35.220225Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:35.220743Z", "completed_at": "2024-04-19T15:02:37.315099Z"}], "thread_id": "Thread-2", "execution_time": 2.1008708477020264, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "b5da594c-1ef4-418e-a20f-2c49dbc9a6b0", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_af_id", "compiled": true, "compiled_code": "SELECT\n    cast(user_id as numeric) as user_id\n    , client_id AS appsflyer_id\n    , af.install_time_dt\nFROM (\n    SELECT\n        *\n        , ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY dt DESC) AS row_num\n    FROM `analytics-147612`.`wh_raw`.`users_cids_all`\n    WHERE user_id IN (SELECT DISTINCT user_id FROM `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`)\n) AS s\n    INNER JOIN `analytics-147612`.`wh_raw`.`mobile_appsflyer` AS af\n        ON s.client_id = af.appsflyer_id\n            AND af.event_time_dt >= '2024-01-01'\nWHERE s.row_num = 1", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_af_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:35.931034Z", "completed_at": "2024-04-19T15:02:35.936568Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:35.937271Z", "completed_at": "2024-04-19T15:02:37.772871Z"}], "thread_id": "Thread-3", "execution_time": 1.8442938327789307, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "4c306f3a-0b84-48ee-a761-facb5fb2eaba", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_notreg_pushes", "compiled": true, "compiled_code": "select *\nfrom `analytics-147612`.`dev_gsokolov`.`stg_pushes`\nwhere status = 'failed' and error = 'NotRegistered'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_notreg_pushes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:36.863026Z", "completed_at": "2024-04-19T15:02:36.866349Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:36.866851Z", "completed_at": "2024-04-19T15:02:38.733341Z"}], "thread_id": "Thread-4", "execution_time": 1.8717577457427979, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "4c7a5dd7-8cd1-42b8-ac98-75e7b8db6688", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.ab_stats_grouped", "compiled": true, "compiled_code": "SELECT\n    variant,\n    COUNT(DISTINCT user_id) AS user_count,\n    ROUND(AVG(XAUUSD_vol), 4)\n        AS avg_vol_XAUUSD,\n    ROUND(STDDEV(XAUUSD_vol), 4)\n        AS std_volume_XAUUSD,\n    SUM(XAUUSD_deals_cnt)\n        AS total_deals_XAUUSD,\n    SUM(XAUUSD_vol) AS vol_XAUUSD,\n    SUM(symbol_volume) AS total_vol,\n    SUM(XAUUSD_converted) AS total_converted,\n    SUM(deals_cnt) AS total_deals\nFROM\n    `analytics-147612`.`dev_gsokolov`.`ab_stats`\nGROUP BY variant", "relation_name": "`analytics-147612`.`dev_gsokolov`.`ab_stats_grouped`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:37.322015Z", "completed_at": "2024-04-19T15:02:37.324967Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:37.325569Z", "completed_at": "2024-04-19T15:02:39.551121Z"}], "thread_id": "Thread-2", "execution_time": 2.2307839393615723, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "71e3c52f-701e-487e-bcfd-73a612e72599", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_users_af", "compiled": true, "compiled_code": "select\n    u.*,\n    af.appsflyer_id,\n    af.install_time_dt\nfrom `analytics-147612`.`dev_gsokolov`.`stg_users` as u\ninner join\n    `analytics-147612`.`dev_gsokolov`.`int_af_id` as af\n    on u.user_id = af.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_users_af`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:37.776252Z", "completed_at": "2024-04-19T15:02:37.779321Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:37.779994Z", "completed_at": "2024-04-19T15:02:39.720599Z"}], "thread_id": "Thread-3", "execution_time": 1.9465620517730713, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d32b3809-e1db-4c03-ad54-c016955e3b10", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_notreg_user_id", "compiled": true, "compiled_code": "with\nfirst_not_registered as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp\n    from `analytics-147612`.`dev_gsokolov`.`int_notreg_pushes`\n    where error = \"NotRegistered\"\n    group by user_id\n)\n\nselect distinct\n    uep.user_id,\n    fnr.first_error_timestamp\nfrom `analytics-147612`.`dev_gsokolov`.`int_notreg_pushes` as uep\ninner join first_not_registered as fnr on uep.user_id = fnr.user_id\ngroup by 1, 2", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:34.008720Z", "completed_at": "2024-04-19T15:02:36.938110Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:36.938776Z", "completed_at": "2024-04-19T15:02:39.841607Z"}], "thread_id": "Thread-1", "execution_time": 5.8355491161346436, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "3ceca7e8-8668-4b42-bb8c-dc44375be1b8", "slot_ms": 267}, "message": "CREATE TABLE (1.0 rows, 0 processed)", "failures": null, "unique_id": "model.dbt_octafx.dummy_id", "compiled": true, "compiled_code": "\n\nSELECT 17367040 as user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`dummy_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:39.729663Z", "completed_at": "2024-04-19T15:02:39.734284Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:39.737920Z", "completed_at": "2024-04-19T15:02:41.518721Z"}], "thread_id": "Thread-2", "execution_time": 1.7933449745178223, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "0cb5e932-081e-4453-a41b-148cb67c19eb", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_pushes_enum", "compiled": true, "compiled_code": "with\n    pushes as (\n        select\n            *,\n            row_number() over (\n                partition by user_id order by cast(timestamp as datetime)\n            ) as event_number\n        from `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`\n        where user_id in (select distinct user_id from `analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`)\n        and (action_type = 'mobile notification' and status in ('delivered', 'clicked', 'failed'))\n    ),\n    first_not_registered as (\n        select\n            user_id,\n            min(cast(timestamp as datetime)) as first_error_timestamp,\n            min(event_number) as first_error_event_number\n        from pushes\n        where error = \"NotRegistered\"\n        group by user_id\n    ),\n    first_error_event as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp\n    from\n        pushes\n    where\n        error = 'NotRegistered'\n    group by\n        user_id\n),\nnext_delivered_event as (\n    select\n        e.user_id,\n        min(cast(e.timestamp as datetime)) as next_delivered_timestamp\n    from\n        pushes e\n    join\n        first_error_event fee on e.user_id = fee.user_id\n    where\n        e.status = 'delivered' and cast(e.timestamp as datetime) > fee.first_error_timestamp\n    group by\n        e.user_id\n)\nselect\n    fee.user_id,\n    fee.first_error_timestamp,\n    nde.next_delivered_timestamp,\n    date_diff(nde.next_delivered_timestamp, fee.first_error_timestamp, second) as time_difference_in_seconds\nfrom\n    first_error_event fee\nleft join\n    next_delivered_event nde on fee.user_id = nde.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_pushes_enum`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-19T15:02:39.727002Z", "completed_at": "2024-04-19T15:02:39.732136Z"}, {"name": "execute", "started_at": "2024-04-19T15:02:39.732891Z", "completed_at": "2024-04-19T15:02:41.930431Z"}], "thread_id": "Thread-4", "execution_time": 2.205618143081665, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "81eec1ec-9a28-4919-9963-39081724fa62", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_events_enum", "compiled": true, "compiled_code": "with\nevents as (\n    select\n        *,\n        row_number() over (\n            partition by user_id order by cast(timestamp as datetime)\n        ) as event_number\n    from `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`\n    where\n        user_id in (select distinct user_id from `analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`)\n        and status in ('delivered', 'clicked', 'failed')\n),\n\nfirst_not_registered as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp,\n        min(event_number) as first_error_event_number\n    from events\n    where error = \"NotRegistered\"\n    group by user_id\n)\n\nselect\n    cast(e.user_id as numeric) as user_id,\n    country_code,\n    registered_dt,\n    status,\n    campaign_id,\n    consent_category,\n    sent_timestamp,\n    action_name,\n    action_id,\n    campaign_name,\n    platform,\n    campaign_trigger,\n    action_type,\n    ingest_timestamp,\n    timestamp,\n    type,\n    fnr.first_error_timestamp,\n    cast(fnr.first_error_event_number as numeric) as first_error_event_number\nfrom events as e\nleft join first_not_registered as fnr on e.user_id = fnr.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_events_enum`"}], "elapsed_time": 21.00264883041382, "args": {"log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "include_saved_query": false, "vars": {}, "enable_legacy_logger": false, "select": [], "use_colors_file": true, "write_json": true, "macro_debugging": false, "printer_width": 80, "indirect_selection": "eager", "exclude": [], "project_dir": "/Users/gsokolov/Library/CloudStorage/Dropbox/dbt_octafx", "use_colors": true, "show_resource_report": false, "send_anonymous_usage_stats": true, "introspect": true, "log_path": "/Users/gsokolov/Library/CloudStorage/Dropbox/dbt_octafx/logs", "invocation_command": "dbt build --project-dir=/Users/gsokolov/Library/CloudStorage/Dropbox/dbt_octafx --write-json --partial-parse", "strict_mode": false, "profiles_dir": "/Users/gsokolov/.dbt", "which": "build", "partial_parse_file_diff": true, "cache_selected_only": false, "populate_cache": true, "print": true, "log_file_max_bytes": 10485760, "log_format": "default", "partial_parse": true, "resource_types": [], "log_level_file": "debug", "defer": false, "show": false, "version_check": true, "favor_state": false, "quiet": false, "static_parser": true}}