{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.12", "generated_at": "2024-04-23T10:47:53.971244Z", "invocation_id": "19391e77-b853-4cbe-b46d-6d53453033fd", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:28.011523Z", "completed_at": "2024-04-23T10:47:28.030226Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:28.061950Z", "completed_at": "2024-04-23T10:47:30.329769Z"}], "thread_id": "Thread-1", "execution_time": 2.3244872093200684, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d71b2778-d3f9-48a1-a210-a28481481735", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.ab_users", "compiled": true, "compiled_code": "WITH\neligible AS (\n    SELECT\n        properties.variant AS variant,\n        SAFE_CAST(user_id AS INT64) AS user_id\n    FROM `analytics-147612`.`bloomreach_raw`.`campaign`\n    WHERE\n        campaign_id = \"65733b51df03a1daadeb772d\"\n        AND action_id = 437\n)\n\nSELECT\n    user_id,\n    variant\nFROM eligible\n", "relation_name": "`analytics-147612`.`dev_gsokolov`.`ab_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:28.025034Z", "completed_at": "2024-04-23T10:47:28.029896Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:28.059357Z", "completed_at": "2024-04-23T10:47:30.331663Z"}], "thread_id": "Thread-4", "execution_time": 2.323047161102295, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "c78cc5a5-787a-45d5-9388-6b46edb1ad6a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.funnel_bloomreach_events", "compiled": true, "compiled_code": "\n\nSELECT\n  action_id,\n  properties.action_name,\n  properties.action_type,\n  campaign_id,\n  event_number,\n  properties.platform,\n  properties.status,\n  timestamp,\n  user_id,\n  properties.variant\nFROM\n  (\n    SELECT\n      *,\n      ROW_NUMBER() OVER (\n        PARTITION BY user_id\n        ORDER BY\n          timestamp ASC\n      ) AS event_number\n    FROM\n      `analytics-147612`.`bloomreach_raw`.`campaign`\n    WHERE\n      timestamp >= '2024-04-01' and \n      properties.action_type in ('mobile notification', 'email', 'split')\n  ) AS bloomreach_events\nGROUP BY\n  action_id,\n  properties.action_name,\n  properties.action_type,\n  campaign_id,\n  event_number,\n  properties.platform,\n  properties.status,\n  timestamp,\n  user_id,\n  properties.variant", "relation_name": "`analytics-147612`.`dev_gsokolov`.`funnel_bloomreach_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:28.020849Z", "completed_at": "2024-04-23T10:47:28.029366Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:28.041268Z", "completed_at": "2024-04-23T10:47:30.512007Z"}], "thread_id": "Thread-2", "execution_time": 2.5058600902557373, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "b44b319f-a19f-446c-a2b5-eb2dab0e07e7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.appsflyer_uninstall_events_report", "compiled": true, "compiled_code": "with source as (\n\n    select * from `analytics-147612`.`wh_raw`.`appsflyer_uninstall_events_report`\n\n),\n\nrenamed as (\n\n    select\n        install_time,\n        event_time,\n        event_value,\n        campaign,\n        campaign_id,\n        region,\n        country_code,\n        appsflyer_id,\n        customer_user_id,\n        platform,\n        os_version,\n        app_version,\n        sdk_version,\n        app_id,\n        app_name,\n        bundle_id,\n        user_agent,\n        google_play_referrer,\n        google_play_click_time,\n        google_play_install_begin_time\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`analytics-147612`.`dev_gsokolov`.`appsflyer_uninstall_events_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:30.340588Z", "completed_at": "2024-04-23T10:47:30.355157Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:30.356006Z", "completed_at": "2024-04-23T10:47:32.725313Z"}], "thread_id": "Thread-1", "execution_time": 2.3940041065216064, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "4bc7abd9-8a1c-49cf-b129-1788a6a8c76e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.funnel_deals", "compiled": true, "compiled_code": "\n\nSELECT\n    user_id\n    , cmd\n    , open_time_dt AS timestamp\n    , symbol_name\nFROM `analytics-147612`.`wh_raw`.`trading_real_raw`\nWHERE open_time_dt >= TIMESTAMP_TRUNC(TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 30 DAY), MONTH)\n    AND open_time_dt < TIMESTAMP_TRUNC(CURRENT_TIMESTAMP(), DAY) and cmd < 2\n    and symbol_name = 'XAUUSD'\nGROUP BY user_id, cmd, timestamp, symbol_name", "relation_name": "`analytics-147612`.`dev_gsokolov`.`funnel_deals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:30.530239Z", "completed_at": "2024-04-23T10:47:30.533559Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:30.534347Z", "completed_at": "2024-04-23T10:47:32.839839Z"}], "thread_id": "Thread-2", "execution_time": 2.321892023086548, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "acc684ee-1e78-4711-b720-c385432c14ac", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_af_events", "compiled": true, "compiled_code": "SELECT\n    af.id,\n    af.appsflyer_id\n    -- , af_id.user_id\n    , media_source\n    , af_channel\n    , campaign\n    , country_code\n    , af.ip\n    , af.platform\n    , af.device_type\n    , af.os_version\n    , af.app_version\n    , af.sdk_version\n    , af.app_id\n    , af.app_name\n    , af.bundle_id\n    , af.event_name\n    , af.event_value\n    , af.device_model\n    , af.device_brand\n    , af.event_type\n    , af.event_time_dt\n    , af.install_time_dt\n    , af.store_reinstall\n    , af.install_app_store\nFROM `analytics-147612`.`wh_raw`.`mobile_appsflyer` AS af\nWHERE af.event_time_dt >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_af_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:28.022919Z", "completed_at": "2024-04-23T10:47:28.028987Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:28.031947Z", "completed_at": "2024-04-23T10:47:32.959477Z"}], "thread_id": "Thread-3", "execution_time": 4.9532310962677, "adapter_response": {"_message": "CREATE TABLE (257.0 rows, 10.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 257, "bytes_processed": 11188, "bytes_billed": 20971520, "location": "EU", "project_id": "analytics-147612", "job_id": "b785ea3f-18f9-4ea4-bb94-5f7ad92b37a5", "slot_ms": 4826}, "message": "CREATE TABLE (257.0 rows, 10.9 KiB processed)", "failures": null, "unique_id": "model.dbt_octafx.countries", "compiled": true, "compiled_code": "\n\nSELECT\n    c.country,\n    c.code,\n    ct.tier,\n    concat(\"Tier \", ct.tier_id) as tier_name\nFROM `analytics-147612`.`wh_raw`.`countries` AS c\nLEFT JOIN\n    `analytics-147612`.`wh_raw`.`countries_tiers` AS ct\n    ON c.country = ct.country", "relation_name": "`analytics-147612`.`dev_gsokolov`.`countries`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:32.744231Z", "completed_at": "2024-04-23T10:47:32.749037Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:32.749767Z", "completed_at": "2024-04-23T10:47:34.939022Z"}], "thread_id": "Thread-1", "execution_time": 2.197998046875, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "b906477b-6e7c-4b9c-b2b7-5f18d4ed9904", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_bloomreach_events", "compiled": true, "compiled_code": "\n\nselect\n    c.type,\n    c.ingest_timestamp,\n    c.timestamp,\n    properties.action_type,\n    properties.campaign_trigger,\n    properties.language,\n    properties.platform,\n    properties.campaign_name,\n    properties.action_id,\n    properties.campaign_policy,\n    -- properties.subject,\n    properties.action_name,\n    properties.recipient,\n    -- properties.message,\n    properties.sent_timestamp,\n    properties.consent_category,\n    properties.campaign_id,\n    properties.status,\n    properties.integration_id,\n    properties.message_id,\n    properties.integration_name,\n    properties.utm_campaign,\n    properties.utm_medium,\n    properties.utm_source,\n    properties.code,\n    properties.message_type,\n    properties.sender,\n    properties.sending_ip,\n    properties.country,\n    properties.city,\n    properties.ip,\n    properties.state,\n    properties.longitude,\n    properties.status_code,\n    properties.error,\n    properties.event_type,\n    properties.symbol,\n    properties.redirect_to_screen,\n    properties.template_name,\n    properties.title,\n    properties.attempts,\n    properties.delta_time,\n    properties.os,\n    properties.location,\n    properties.device,\n    properties.action_url,\n    safe_cast(c.user_id as numeric) as user_id\nfrom `analytics-147612`.`bloomreach_raw`.`campaign` as c\nwhere\n    timestamp_trunc(c.timestamp, day) >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:32.863410Z", "completed_at": "2024-04-23T10:47:32.867160Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:32.867981Z", "completed_at": "2024-04-23T10:47:35.127811Z"}], "thread_id": "Thread-2", "execution_time": 2.2666239738464355, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "09628fa9-88eb-4e7e-8185-b5f6667e2005", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_users", "compiled": true, "compiled_code": "select\n    user_id,\n    country_code,\n    registered_dt\nfrom\n    `analytics-147612`.`wh_raw`.`users`\nwhere registered_dt >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:32.977372Z", "completed_at": "2024-04-23T10:47:32.983254Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:32.984331Z", "completed_at": "2024-04-23T10:47:35.248529Z"}], "thread_id": "Thread-3", "execution_time": 2.284963846206665, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "c88bf388-59e0-43a7-9187-de248234f07e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.tokens", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT\n        *\n    FROM\n        `analytics-147612`.`bloomreach_raw`.`customers_properties`\n),\nrenamed AS (\n    SELECT\n        properties.user_id,\n        properties.google_push_notification_id\n    FROM\n        source\n)\nSELECT\n    *\nFROM\n    renamed", "relation_name": "`analytics-147612`.`dev_gsokolov`.`tokens`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:34.961827Z", "completed_at": "2024-04-23T10:47:34.965194Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:34.966036Z", "completed_at": "2024-04-23T10:47:37.166912Z"}], "thread_id": "Thread-1", "execution_time": 2.2077889442443848, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "24269a0f-a722-4aa8-9038-8fe64bff6d89", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.users_cids_all", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from `analytics-147612`.`wh_raw`.`users_cids_all`\n\n),\n\nrenamed as (\n\n    select\n        client_id,\n        user_id,\n        dt,\n        src_info\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`analytics-147612`.`dev_gsokolov`.`users_cids_all`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:30.345611Z", "completed_at": "2024-04-23T10:47:33.167367Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:33.168551Z", "completed_at": "2024-04-23T10:47:38.383499Z"}], "thread_id": "Thread-4", "execution_time": 8.053667068481445, "adapter_response": {"_message": "CREATE TABLE (11.0k rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 10958, "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d9ef344b-a2cb-482e-9824-caa5dbd242dc", "slot_ms": 96320}, "message": "CREATE TABLE (11.0k rows, 0 processed)", "failures": null, "unique_id": "model.dbt_octafx.metricflow_time_spine", "compiled": true, "compiled_code": "-- filename: metricflow_time_spine.sql\n-- BigQuery supports DATE() instead of TO_DATE(). Use this model if you're using BigQuery\n\nwith days as (\n    \n\n\n    \n\n\n    with rawdata as (\n\n        \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n     + \n    \n    p13.generated_number * power(2, 13)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n     cross join \n    \n    p as p13\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 10958\n    order by generated_number\n\n\n\n    ),\n\n    all_periods as (\n\n        select (\n            \n\n        datetime_add(\n            cast( DATE(2000,01,01) as datetime),\n        interval row_number() over (order by 1) - 1 day\n        )\n\n\n        ) as date_day\n        from rawdata\n\n    ),\n\n    filtered as (\n\n        select *\n        from all_periods\n        where date_day <= DATE(2030,01,01)\n\n    )\n\n    select * from filtered\n\n\n),\n\nfinal as (\n    select cast(date_day as date) as date_day\n    from days\n)\n\nselect *\nfrom final", "relation_name": "`analytics-147612`.`dev_gsokolov`.`metricflow_time_spine`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:37.186515Z", "completed_at": "2024-04-23T10:47:37.189955Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:37.190584Z", "completed_at": "2024-04-23T10:47:39.587051Z"}], "thread_id": "Thread-1", "execution_time": 2.404381036758423, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "cad58d90-a64d-45e4-91b8-7c6157d088e9", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.user_deals", "compiled": true, "compiled_code": "SELECT \n    u.user_id,\n    u.variant,\n    COALESCE(t.operation_id, 0) AS operation_id,\n    COALESCE(t.symbol_name, '') AS symbol_name,\n    COALESCE(t.cmd, 0) AS cmd,\n    COALESCE(t.volume, 0) AS volume,\n    COALESCE(t.open_price, 0) AS open_price,\n    COALESCE(t.close_price, 0) AS close_price,\n    COALESCE(t.profit, 0) AS profit,\n    COALESCE(t.open_time_dt, CAST('1970-01-01' AS TIMESTAMP)) AS open_time_dt,\n    COALESCE(t.close_time_dt, CAST('1970-01-01' AS TIMESTAMP)) AS close_time_dt,\n    COALESCE(DATE(DATE_TRUNC(t.open_time_dt, DAY)), DATE('1970-01-01')) AS trade_day\nFROM \n    `analytics-147612`.`dev_gsokolov`.`ab_users` u\n    LEFT JOIN `analytics-147612`.`wh_raw`.`trading_real_raw` AS t ON u.user_id = t.user_id\n        AND (DATE(t.open_time_dt) BETWEEN '2024-04-02' AND '2024-04-09')\n        AND (DATE(t.close_time_dt) BETWEEN '2024-04-02' AND '2024-04-09')\n        AND t.cmd < 2", "relation_name": "`analytics-147612`.`dev_gsokolov`.`user_deals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:38.408638Z", "completed_at": "2024-04-23T10:47:38.411961Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:38.412460Z", "completed_at": "2024-04-23T10:47:41.039588Z"}], "thread_id": "Thread-4", "execution_time": 2.6337931156158447, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "29b1adc5-e55c-4e3f-9d09-14c7c4711e2c", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.event_stream", "compiled": true, "compiled_code": "\n\n\n\n\nWITH bloomreach_events AS (\n    SELECT\n        action_type AS event_type,\n        timestamp,\n        cast(user_id as int) user_id,\n        'communication' AS event_nature\n    FROM\n        `analytics-147612`.`dev_gsokolov`.`funnel_bloomreach_events`\n    WHERE\n        timestamp >= '2024-04-01' AND\n        timestamp <= '2024-04-10'\n),\n\ndeals AS (\n    SELECT\n        cast(cmd as string) AS event_type,\n        timestamp,\n        user_id,\n        'deal' AS event_nature\n    FROM\n        `analytics-147612`.`dev_gsokolov`.`funnel_deals`\n    WHERE\n        timestamp >= '2024-04-01' AND\n        timestamp <= '2024-04-10'\n)\n\nSELECT * FROM bloomreach_events\nUNION ALL\nSELECT * FROM deals\nORDER BY user_id, timestamp", "relation_name": "`analytics-147612`.`dev_gsokolov`.`event_stream`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:39.607801Z", "completed_at": "2024-04-23T10:47:39.613868Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:39.614648Z", "completed_at": "2024-04-23T10:47:42.156472Z"}], "thread_id": "Thread-1", "execution_time": 2.5502912998199463, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "e60312c0-d84c-4c54-9e43-1588d72dc33b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_pushes", "compiled": true, "compiled_code": "select ue.*\nfrom `analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events` as ue\nwhere action_type = 'mobile notification'\nand status in ('delivered', 'clicked', 'failed')", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_pushes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:41.059483Z", "completed_at": "2024-04-23T10:47:41.064684Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:41.065852Z", "completed_at": "2024-04-23T10:47:43.508658Z"}], "thread_id": "Thread-4", "execution_time": 2.4521589279174805, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "aeb404af-04a7-40bc-9293-26c16d235a32", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_bloomreach_events_enhanced", "compiled": true, "compiled_code": "select\n    c.*,\n    u.country_code,\n    u.registered_dt\nfrom `analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events` as c\ninner join `analytics-147612`.`dev_gsokolov`.`stg_users` as u\n    on\n        safe_cast(c.user_id as integer) = u.user_id\n        and timestamp_trunc(\n            c.timestamp, day\n        ) between u.registered_dt and u.registered_dt\n        + interval 28 day", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:35.141369Z", "completed_at": "2024-04-23T10:47:35.141379Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:35.144627Z", "completed_at": "2024-04-23T10:47:43.512191Z"}], "thread_id": "Thread-2", "execution_time": 8.38066577911377, "adapter_response": {"_message": "INSERT 8596", "code": "INSERT", "rows_affected": 8596}, "message": "INSERT 8596", "failures": null, "unique_id": "seed.dbt_octafx.ETHUSD_random", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:35.274996Z", "completed_at": "2024-04-23T10:47:35.274998Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:35.275486Z", "completed_at": "2024-04-23T10:47:43.880955Z"}], "thread_id": "Thread-3", "execution_time": 8.607528924942017, "adapter_response": {"_message": "INSERT 4855", "code": "INSERT", "rows_affected": 4855}, "message": "INSERT 4855", "failures": null, "unique_id": "seed.dbt_octafx.XNGUSD_random", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:43.524406Z", "completed_at": "2024-04-23T10:47:43.536096Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:43.536887Z", "completed_at": "2024-04-23T10:47:46.008142Z"}], "thread_id": "Thread-2", "execution_time": 2.490967035293579, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "c66e62b7-ab06-4dd0-ac86-a7a9dae03ec7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.funnel_dbt", "compiled": true, "compiled_code": "\n\n\n\n\n  with event_stream as (  \n  select event_nature as event_type, user_id as user_id, timestamp as event_date\n  from `analytics-147612`.`dev_gsokolov`.`event_stream`\n  where 1 = 1\n  \n  \n\n    \n    \n    \n   )\n  \n    , event_stream_step_1 as (\n      select event_stream.* \n      from event_stream\n      \n      where event_stream.event_type = 'communication'\n    )\n\n    , step_1 as (\n      select count(distinct user_id) as unique_users \n      from event_stream_step_1\n    )  \n\n  \n    , event_stream_step_2 as (\n      select event_stream.* \n      from event_stream\n      \n        inner join event_stream_step_1 as previous_events\n          on event_stream.user_id = previous_events.user_id\n          and previous_events.event_type = 'communication'\n          and previous_events.event_date <= event_stream.event_date\n      \n      where event_stream.event_type = 'deal'\n    )\n\n    , step_2 as (\n      select count(distinct user_id) as unique_users \n      from event_stream_step_2\n    )  \n\n  \n\n  , event_funnel as (\n    \n      select 'communication' as event_type, unique_users, 1 as step_index\n      from step_1\n      \n        union all\n      \n    \n      select 'deal' as event_type, unique_users, 2 as step_index\n      from step_2\n      \n    \n  )\n\n  , final as (\n    select event_type\n      , unique_users, 1.0 * unique_users / nullif(first_value(unique_users) over(order by step_index), 0) as pct_conversion\n      , 1.0 * unique_users / nullif(lag(unique_users) over(order by step_index), 0) as pct_of_previous\n    from event_funnel\n  )\n\n  select * from final\n", "relation_name": "`analytics-147612`.`dev_gsokolov`.`funnel_dbt`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:43.519318Z", "completed_at": "2024-04-23T10:47:43.535293Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:43.539474Z", "completed_at": "2024-04-23T10:47:46.005982Z"}], "thread_id": "Thread-4", "execution_time": 2.4915308952331543, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "52eca9c0-e9bc-4078-969b-02f927c4db80", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.ab_stats", "compiled": true, "compiled_code": "WITH stats AS (\n    SELECT\n        user_id,\n        variant,\n        COUNT(DISTINCT operation_id) AS deals_cnt,\n        COALESCE(SUM(volume), 0) AS symbol_volume,\n        COALESCE(\n            SUM(\n                CASE\n                    WHEN\n                        symbol_name = 'XAUUSD'\n                        THEN volume ELSE\n                        0\n                END\n            ),\n            0\n        ) AS XAUUSD_vol,\n        MIN(\n            CASE\n                WHEN symbol_name = 'XAUUSD' THEN open_time_dt\n            END\n        )\n            AS first_XAUUSD_deal,\n        COALESCE(\n            SUM(\n                CASE\n                    WHEN symbol_name = 'XAUUSD' THEN 1 ELSE 0\n                END\n            ),\n            0\n        )\n            AS XAUUSD_deals_cnt,\n        IF(\n            COALESCE(\n                SUM(\n                    CASE\n                        WHEN\n                            symbol_name = 'XAUUSD'\n                            THEN 1 ELSE\n                            0\n                    END\n                ),\n                0\n            )\n            > 0,\n            1,\n            0\n        ) AS XAUUSD_converted\n    FROM\n        `analytics-147612`.`dev_gsokolov`.`user_deals`\n    GROUP BY\n        user_id, variant\n)\n\nSELECT\n    user_id,\n    variant,\n    deals_cnt,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY deals_cnt)\n        AS deals_cnt_percentile,\n    symbol_volume,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY symbol_volume)\n        AS symbol_volume_percentile,\n    XAUUSD_vol,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY XAUUSD_vol)\n        AS XAUUSD_vol_percentile,\n    COALESCE(CAST(first_XAUUSD_deal AS STRING), 'N/A')\n        AS first_XAUUSD_deal,\n    XAUUSD_deals_cnt,\n    PERCENT_RANK()\n        OVER (PARTITION BY variant ORDER BY XAUUSD_deals_cnt)\n        AS XAUUSD_deals_cnt_percentile,\n    XAUUSD_converted\nFROM\n    stats\nORDER BY\n    deals_cnt DESC", "relation_name": "`analytics-147612`.`dev_gsokolov`.`ab_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:43.886540Z", "completed_at": "2024-04-23T10:47:43.890380Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:43.891566Z", "completed_at": "2024-04-23T10:47:46.612761Z"}], "thread_id": "Thread-3", "execution_time": 2.7287919521331787, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "762e6c08-99d0-4cf2-bb62-4f73a525ed05", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_notreg_pushes", "compiled": true, "compiled_code": "select *\nfrom `analytics-147612`.`dev_gsokolov`.`stg_pushes`\nwhere status = 'failed' and error = 'NotRegistered'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_notreg_pushes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:46.015949Z", "completed_at": "2024-04-23T10:47:46.022992Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:46.023945Z", "completed_at": "2024-04-23T10:47:48.488139Z"}], "thread_id": "Thread-2", "execution_time": 2.475992202758789, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "07635d9d-f8c9-47cb-a8f7-5a12c10cbe84", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_af_id", "compiled": true, "compiled_code": "SELECT\n    cast(user_id as numeric) as user_id\n    , client_id AS appsflyer_id\n    , af.install_time_dt\nFROM (\n    SELECT\n        *\n        , ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY dt DESC) AS row_num\n    FROM `analytics-147612`.`wh_raw`.`users_cids_all`\n    WHERE user_id IN (SELECT DISTINCT user_id FROM `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`)\n) AS s\n    INNER JOIN `analytics-147612`.`wh_raw`.`mobile_appsflyer` AS af\n        ON s.client_id = af.appsflyer_id\n            AND af.event_time_dt >= '2024-01-01'\nWHERE s.row_num = 1", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_af_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:46.019492Z", "completed_at": "2024-04-23T10:47:46.023657Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:46.028252Z", "completed_at": "2024-04-23T10:47:48.634674Z"}], "thread_id": "Thread-4", "execution_time": 2.619908094406128, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "3047060e-cb71-40f8-a12a-497c8549edf0", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.ab_stats_grouped", "compiled": true, "compiled_code": "SELECT\n    variant,\n    COUNT(DISTINCT user_id) AS user_count,\n    ROUND(AVG(XAUUSD_vol), 4)\n        AS avg_vol_XAUUSD,\n    ROUND(STDDEV(XAUUSD_vol), 4)\n        AS std_volume_XAUUSD,\n    SUM(XAUUSD_deals_cnt)\n        AS total_deals_XAUUSD,\n    SUM(XAUUSD_vol) AS vol_XAUUSD,\n    SUM(symbol_volume) AS total_vol,\n    SUM(XAUUSD_converted) AS total_converted,\n    SUM(deals_cnt) AS total_deals\nFROM\n    `analytics-147612`.`dev_gsokolov`.`ab_stats`\nGROUP BY variant", "relation_name": "`analytics-147612`.`dev_gsokolov`.`ab_stats_grouped`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:46.616144Z", "completed_at": "2024-04-23T10:47:46.619155Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:46.619903Z", "completed_at": "2024-04-23T10:47:49.248664Z"}], "thread_id": "Thread-3", "execution_time": 2.634369134902954, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "b773baf3-3983-4ee4-988d-81bf2660feb1", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_notreg_user_id", "compiled": true, "compiled_code": "with\nfirst_not_registered as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp\n    from `analytics-147612`.`dev_gsokolov`.`int_notreg_pushes`\n    where error = \"NotRegistered\"\n    group by user_id\n)\n\nselect distinct\n    uep.user_id,\n    fnr.first_error_timestamp\nfrom `analytics-147612`.`dev_gsokolov`.`int_notreg_pushes` as uep\ninner join first_not_registered as fnr on uep.user_id = fnr.user_id\ngroup by 1, 2", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:42.164716Z", "completed_at": "2024-04-23T10:47:46.031568Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:46.034228Z", "completed_at": "2024-04-23T10:47:49.710290Z"}], "thread_id": "Thread-1", "execution_time": 7.548603773117065, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "465c9ec0-a57e-4c2a-82a5-44d675270bc9", "slot_ms": 164}, "message": "CREATE TABLE (1.0 rows, 0 processed)", "failures": null, "unique_id": "model.dbt_octafx.dummy_id", "compiled": true, "compiled_code": "\n\nSELECT 17367040 as user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`dummy_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:48.493140Z", "completed_at": "2024-04-23T10:47:48.498182Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:48.498926Z", "completed_at": "2024-04-23T10:47:50.860017Z"}], "thread_id": "Thread-2", "execution_time": 2.3686561584472656, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "8f717a0f-8b89-4e63-9287-0f1f73dd0219", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.avg_timedelta_per_user", "compiled": true, "compiled_code": "\n\nWITH RankedEvents AS (\n  SELECT\n    i.appsflyer_id,\n    e.timestamp,\n    e.status,\n    e.action_id,\n    e.action_type,\n    e.campaign_name,\n    ROW_NUMBER() OVER (PARTITION BY i.appsflyer_id ORDER BY e.timestamp ASC) AS rank\n  FROM\n    `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced` as e\n    LEFT JOIN `analytics-147612`.`dev_gsokolov`.`int_af_id` AS i ON e.user_id = i.user_id\n  WHERE\n    e.action_type = 'mobile notification'\n),\nFailedEvents AS (\n  SELECT\n    appsflyer_id,\n    timestamp AS failed_timestamp\n  FROM RankedEvents\n  WHERE status = 'failed'\n),\nFirstAttemptEvents AS (\n  SELECT\n    appsflyer_id,\n    timestamp AS first_attempt_timestamp\n  FROM RankedEvents\n  WHERE rank = 1\n),\nTimeDeltas AS (\n  SELECT\n    f.appsflyer_id,\n    TIMESTAMP_DIFF(f.failed_timestamp, a.first_attempt_timestamp, SECOND) AS time_delta_seconds\n  FROM\n    FailedEvents f\n    JOIN FirstAttemptEvents a ON f.appsflyer_id = a.appsflyer_id\n)\nSELECT\n  AVG(time_delta_seconds) AS avg_time_delta_seconds\nFROM\n  TimeDeltas", "relation_name": "`analytics-147612`.`dev_gsokolov`.`avg_timedelta_per_user`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:48.638438Z", "completed_at": "2024-04-23T10:47:48.641459Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:48.642164Z", "completed_at": "2024-04-23T10:47:51.105979Z"}], "thread_id": "Thread-4", "execution_time": 2.469783067703247, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d28c37eb-4103-43f7-98bb-81950ee0d97e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_users_af", "compiled": true, "compiled_code": "select\n    u.*,\n    af.appsflyer_id,\n    af.install_time_dt\nfrom `analytics-147612`.`dev_gsokolov`.`stg_users` as u\ninner join\n    `analytics-147612`.`dev_gsokolov`.`int_af_id` as af\n    on u.user_id = af.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_users_af`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:49.260221Z", "completed_at": "2024-04-23T10:47:49.264061Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:49.265238Z", "completed_at": "2024-04-23T10:47:51.858062Z"}], "thread_id": "Thread-3", "execution_time": 2.601708173751831, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "f31c2fa4-00c0-4b83-ac64-687aa4efa9a1", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.timedelta_helper", "compiled": true, "compiled_code": "SELECT\n  i.appsflyer_id,\n  CASE\n    WHEN status = 'failed' THEN 1\n    WHEN status != 'failed' THEN 0\n  END as if_failed,\n  e.timestamp,\n  e.status,\n  e.action_id,\n  e.action_type,\n  e.campaign_name\nFROM\n  `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced` as e\n  LEFT JOIN `analytics-147612`.`dev_gsokolov`.`int_af_id` AS i ON e.user_id = i.user_id\nWHERE\n  (\n    e.action_type = 'mobile notification'\n  )", "relation_name": "`analytics-147612`.`dev_gsokolov`.`timedelta_helper`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:51.428416Z", "completed_at": "2024-04-23T10:47:51.442253Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:51.444686Z", "completed_at": "2024-04-23T10:47:53.791132Z"}], "thread_id": "Thread-1", "execution_time": 2.373246908187866, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "bc44ba9e-c222-45a0-9857-9b50331eaf7b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.timedelta_per_user", "compiled": true, "compiled_code": "\n\nWITH RankedEvents AS (\n  SELECT\n    i.appsflyer_id,\n    e.timestamp,\n    e.status,\n    e.action_id,\n    e.action_type,\n    e.campaign_name,\n    ROW_NUMBER() OVER (PARTITION BY i.appsflyer_id ORDER BY e.timestamp ASC) AS rank\n  FROM\n    `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced` as e\n    LEFT JOIN `analytics-147612`.`dev_gsokolov`.`int_af_id` AS i ON e.user_id = i.user_id\n  WHERE\n    e.action_type = 'mobile notification'\n),\nFailedEvents AS (\n  SELECT\n    appsflyer_id,\n    timestamp AS failed_timestamp\n  FROM RankedEvents\n  WHERE status = 'failed'\n),\nFirstAttemptEvents AS (\n  SELECT\n    appsflyer_id,\n    timestamp AS first_attempt_timestamp\n  FROM RankedEvents\n  WHERE rank = 1\n)\nSELECT\n  f.appsflyer_id,\n  f.failed_timestamp,\n  a.first_attempt_timestamp,\n  TIMESTAMP_DIFF(f.failed_timestamp, a.first_attempt_timestamp, SECOND) AS time_delta_seconds\nFROM\n  FailedEvents f\n  JOIN FirstAttemptEvents a ON f.appsflyer_id = a.appsflyer_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`timedelta_per_user`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:51.433162Z", "completed_at": "2024-04-23T10:47:51.443869Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:51.452974Z", "completed_at": "2024-04-23T10:47:53.961996Z"}], "thread_id": "Thread-2", "execution_time": 2.5433380603790283, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "72021400-cdff-4826-ab3e-273e1f3ea44c", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_events_enum", "compiled": true, "compiled_code": "with\nevents as (\n    select\n        *,\n        row_number() over (\n            partition by user_id order by cast(timestamp as datetime)\n        ) as event_number\n    from `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`\n    where\n        user_id in (select distinct user_id from `analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`)\n        and status in ('delivered', 'clicked', 'failed')\n),\n\nfirst_not_registered as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp,\n        min(event_number) as first_error_event_number\n    from events\n    where error = \"NotRegistered\"\n    group by user_id\n)\n\nselect\n    cast(e.user_id as numeric) as user_id,\n    country_code,\n    registered_dt,\n    status,\n    campaign_id,\n    consent_category,\n    sent_timestamp,\n    action_name,\n    action_id,\n    campaign_name,\n    platform,\n    campaign_trigger,\n    action_type,\n    ingest_timestamp,\n    timestamp,\n    type,\n    fnr.first_error_timestamp,\n    cast(fnr.first_error_event_number as numeric) as first_error_event_number\nfrom events as e\nleft join first_not_registered as fnr on e.user_id = fnr.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_events_enum`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-23T10:47:51.437758Z", "completed_at": "2024-04-23T10:47:51.443022Z"}, {"name": "execute", "started_at": "2024-04-23T10:47:51.448702Z", "completed_at": "2024-04-23T10:47:53.964949Z"}], "thread_id": "Thread-4", "execution_time": 2.5453178882598877, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "483e1ee4-c64c-4937-98ef-9c3b478de6c1", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_pushes_enum", "compiled": true, "compiled_code": "with\n    pushes as (\n        select\n            *,\n            row_number() over (\n                partition by user_id order by cast(timestamp as datetime)\n            ) as event_number\n        from `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`\n        where user_id in (select distinct user_id from `analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`)\n        and (action_type = 'mobile notification' and status in ('delivered', 'clicked', 'failed'))\n    ),\n    first_not_registered as (\n        select\n            user_id,\n            min(cast(timestamp as datetime)) as first_error_timestamp,\n            min(event_number) as first_error_event_number\n        from pushes\n        where error = \"NotRegistered\"\n        group by user_id\n    ),\n    first_error_event as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp\n    from\n        pushes\n    where\n        error = 'NotRegistered'\n    group by\n        user_id\n),\nnext_delivered_event as (\n    select\n        e.user_id,\n        min(cast(e.timestamp as datetime)) as next_delivered_timestamp\n    from\n        pushes e\n    join\n        first_error_event fee on e.user_id = fee.user_id\n    where\n        e.status = 'delivered' and cast(e.timestamp as datetime) > fee.first_error_timestamp\n    group by\n        e.user_id\n)\nselect\n    fee.user_id,\n    fee.first_error_timestamp,\n    nde.next_delivered_timestamp,\n    date_diff(nde.next_delivered_timestamp, fee.first_error_timestamp, second) as time_difference_in_seconds\nfrom\n    first_error_event fee\nleft join\n    next_delivered_event nde on fee.user_id = nde.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_pushes_enum`"}], "elapsed_time": 30.380109071731567, "args": {"use_colors": true, "enable_legacy_logger": false, "log_format": "default", "log_level": "info", "partial_parse_file_diff": true, "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "include_saved_query": false, "introspect": true, "indirect_selection": "eager", "resource_types": [], "write_json": true, "populate_cache": true, "send_anonymous_usage_stats": true, "cache_selected_only": false, "print": true, "show_resource_report": false, "favor_state": false, "log_format_file": "debug", "strict_mode": false, "quiet": false, "log_path": "/Users/gsokolov/Library/CloudStorage/Dropbox/dbt_octafx/logs", "version_check": true, "printer_width": 80, "profiles_dir": "/Users/gsokolov/.dbt", "which": "build", "show": false, "defer": false, "project_dir": "/Users/gsokolov/Library/CloudStorage/Dropbox/dbt_octafx", "invocation_command": "dbt build --project-dir=/Users/gsokolov/Library/CloudStorage/Dropbox/dbt_octafx", "log_level_file": "debug", "static_parser": true, "vars": {}, "log_file_max_bytes": 10485760, "use_colors_file": true, "exclude": [], "macro_debugging": false, "select": []}}