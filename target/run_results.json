{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-05-29T01:19:55.368293Z", "invocation_id": "dba2580c-714a-4be0-b17e-3a1f7186e282", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:30.120833Z", "completed_at": "2024-05-29T01:19:30.129104Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:30.129624Z", "completed_at": "2024-05-29T01:19:40.807987Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.68805193901062, "adapter_response": {"_message": "CREATE TABLE (1.3m rows, 1.4 GiB processed)", "code": "CREATE TABLE", "rows_affected": 1328714, "bytes_processed": 1533196377, "bytes_billed": 1534066688, "location": "EU", "project_id": "analytics-147612", "job_id": "f344ab3b-11ef-4d63-bbd0-371b9611dcdd", "slot_ms": 238839}, "message": "CREATE TABLE (1.3m rows, 1.4 GiB processed)", "failures": null, "unique_id": "model.dbt_octafx.trading_dynamics_rolling_aggregates", "compiled": true, "compiled_code": "\n\nwith\n    source as (select * from `analytics-147612`.`dev_gsokolov`.`trading_real_raw`), \n\n    filter as (\n        select user_id, operation_id, trading_account_id, symbol_name, open_time_dt, profit, volume\n        from source\n        where open_time_dt >= '2024-05-01' and cmd < 2\n    ),\n\n    period_data as (\n        select\n            user_id,\n            trading_account_id,\n            symbol_name,\n            date_trunc(open_time_dt, week) as period_start,  -- Change this to 'week' or 'month' for different periods\n            sum(profit) as period_profit,\n            sum(volume) as period_volume,\n            count(operation_id) as period_operations\n        from filter\n        group by\n            user_id, trading_account_id, symbol_name, date_trunc(open_time_dt, week)\n    ),\n\n    rolling_aggregates as (\n        select\n            user_id,\n            trading_account_id,\n            symbol_name,\n            period_start,\n            sum(period_profit) over (\n                partition by user_id, trading_account_id, symbol_name\n                order by period_start\n                rows between unbounded preceding and current row\n            ) as cumulative_profit,\n            sum(period_volume) over (\n                partition by user_id, trading_account_id, symbol_name\n                order by period_start\n                rows between unbounded preceding and current row\n            ) as cumulative_volume,\n            avg(period_profit) over (\n                partition by user_id, trading_account_id, symbol_name\n                order by period_start\n                rows between unbounded preceding and current row\n            ) as avg_profit_per_period,\n            avg(period_volume) over (\n                partition by user_id, trading_account_id, symbol_name\n                order by period_start\n                rows between unbounded preceding and current row\n            ) as avg_volume_per_period,\n            sum(period_operations) over (\n                partition by user_id, trading_account_id, symbol_name\n                order by period_start\n                rows between unbounded preceding and current row\n            ) as cumulative_operations,\n            period_profit,\n            period_volume,\n            lag(period_profit) over (\n                partition by user_id, trading_account_id, symbol_name\n                order by period_start\n            ) as prev_period_profit,\n            lag(period_volume) over (\n                partition by user_id, trading_account_id, symbol_name\n                order by period_start\n            ) as prev_period_volume\n        from period_data\n    )\n\nselect\n    *,\n    case\n        when prev_period_profit is null or prev_period_profit = 0\n        then null\n        else (period_profit - prev_period_profit) / prev_period_profit\n    end as profit_change_pct,\n    case\n        when prev_period_volume is null or prev_period_volume = 0\n        then null\n        else (period_volume - prev_period_volume) / prev_period_volume\n    end as volume_change_pct\nfrom rolling_aggregates", "relation_name": "`analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:40.825245Z", "completed_at": "2024-05-29T01:19:40.833340Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:40.834181Z", "completed_at": "2024-05-29T01:19:44.594139Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.7794742584228516, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10629712, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "2b9acc5b-c8fd-4919-b4e5-02e25dce2aa5", "slot_ms": 145}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_avg_volume_per_period.fff8f55a74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_volume_per_period\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere avg_volume_per_period is null\n\n\n", "relation_name": null}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:40.830503Z", "completed_at": "2024-05-29T01:19:40.841155Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:40.847394Z", "completed_at": "2024-05-29T01:19:44.698014Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.882627248764038, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10554008, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "2bff55a9-b1e3-44e2-84ff-b034cfc04c65", "slot_ms": 237}, "message": "Got 9463 results, configured to fail if != 0", "failures": 9463, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_cumulative_profit.078fe95f56", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cumulative_profit\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere cumulative_profit is null\n\n\n", "relation_name": null}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:40.816593Z", "completed_at": "2024-05-29T01:19:40.833613Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:40.844064Z", "completed_at": "2024-05-29T01:19:44.748881Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.9344732761383057, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10554008, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "86ecd543-2910-4129-b30b-d41c0dfb2e98", "slot_ms": 362}, "message": "Got 9463 results, configured to fail if != 0", "failures": 9463, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_avg_profit_per_period.d48841e7d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_profit_per_period\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere avg_profit_per_period is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:40.827975Z", "completed_at": "2024-05-29T01:19:40.833870Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:40.845592Z", "completed_at": "2024-05-29T01:19:44.859845Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.04473614692688, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10629712, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "84175ba5-a45b-4d1d-8888-732b21f2da93", "slot_ms": 110}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_cumulative_operations.58b613e2e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cumulative_operations\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere cumulative_operations is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:44.598975Z", "completed_at": "2024-05-29T01:19:44.604734Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:44.605138Z", "completed_at": "2024-05-29T01:19:48.134888Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.537140369415283, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10629712, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "97d84579-d00d-453c-a53e-99f591ff85b8", "slot_ms": 146}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_cumulative_volume.1568cd4508", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cumulative_volume\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere cumulative_volume is null\n\n\n", "relation_name": null}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:44.700609Z", "completed_at": "2024-05-29T01:19:44.703505Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:44.703733Z", "completed_at": "2024-05-29T01:19:48.244757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.545039176940918, "adapter_response": {"_message": "SELECT (1.0 rows, 10.0 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10473488, "bytes_billed": 10485760, "location": "EU", "project_id": "analytics-147612", "job_id": "abd96e0c-f34f-4790-8280-621ee329b1ef", "slot_ms": 317}, "message": "Got 19528 results, configured to fail if != 0", "failures": 19528, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_period_profit.fc85b66220", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect period_profit\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere period_profit is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:44.861740Z", "completed_at": "2024-05-29T01:19:44.864325Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:44.864521Z", "completed_at": "2024-05-29T01:19:48.328561Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.467480182647705, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10629712, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "900985da-2195-48d0-904f-247d13259750", "slot_ms": 109}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_period_volume.a994ec02fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect period_volume\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere period_volume is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:44.750652Z", "completed_at": "2024-05-29T01:19:44.753312Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:44.753515Z", "completed_at": "2024-05-29T01:19:48.472318Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.722198963165283, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10629712, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "9ed70f83-858b-4ae0-ab20-2bb4e0b239a0", "slot_ms": 108}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_period_start.413b1a4af7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect period_start\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere period_start is null\n\n\n", "relation_name": null}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:48.137884Z", "completed_at": "2024-05-29T01:19:48.140370Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:48.140601Z", "completed_at": "2024-05-29T01:19:51.764603Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.6272549629211426, "adapter_response": {"_message": "SELECT (1.0 rows, 4.8 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 5001128, "bytes_billed": 10485760, "location": "EU", "project_id": "analytics-147612", "job_id": "3fbc5bde-2dd5-4b77-b3ec-9f5a617fcfa2", "slot_ms": 550}, "message": "Got 703573 results, configured to fail if != 0", "failures": 703573, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_profit_change_pct.80de32c49b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect profit_change_pct\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere profit_change_pct is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:48.247338Z", "completed_at": "2024-05-29T01:19:48.249969Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:48.250169Z", "completed_at": "2024-05-29T01:19:52.015628Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7688839435577393, "adapter_response": {"_message": "SELECT (1.0 rows, 10.2 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10661601, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "9880658a-ccdc-4eb7-ba0b-f54e3fe9911f", "slot_ms": 131}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_symbol_name.be79ba510b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect symbol_name\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere symbol_name is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:48.330518Z", "completed_at": "2024-05-29T01:19:48.333300Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:48.333521Z", "completed_at": "2024-05-29T01:19:52.114339Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.784493923187256, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10629712, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "8fcde5c1-5a9a-428b-b07e-2b544b18fa38", "slot_ms": 114}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_trading_account_id.be57fc6037", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trading_account_id\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere trading_account_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:48.474135Z", "completed_at": "2024-05-29T01:19:48.476700Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:48.476915Z", "completed_at": "2024-05-29T01:19:52.452982Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.979647159576416, "adapter_response": {"_message": "SELECT (1.0 rows, 10.1 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 10629712, "bytes_billed": 11534336, "location": "EU", "project_id": "analytics-147612", "job_id": "e69e22ae-2891-4fac-8ac5-910d260f261d", "slot_ms": 144}, "message": null, "failures": 0, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_user_id.d20d97c29b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2024-05-29T01:19:51.767484Z", "completed_at": "2024-05-29T01:19:51.770796Z"}, {"name": "execute", "started_at": "2024-05-29T01:19:51.771059Z", "completed_at": "2024-05-29T01:19:55.361530Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.5950710773468018, "adapter_response": {"_message": "SELECT (1.0 rows, 4.9 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 5104936, "bytes_billed": 10485760, "location": "EU", "project_id": "analytics-147612", "job_id": "7c1a2f07-8443-4e02-a573-9ceced07ab45", "slot_ms": 289}, "message": "Got 690597 results, configured to fail if != 0", "failures": 690597, "unique_id": "test.dbt_octafx.not_null_trading_dynamics_rolling_aggregates_volume_change_pct.489f08c3f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect volume_change_pct\nfrom `analytics-147612`.`dev_gsokolov`.`trading_dynamics_rolling_aggregates`\nwhere volume_change_pct is null\n\n\n", "relation_name": null}], "elapsed_time": 30.43769598007202, "args": {"indirect_selection": "eager", "show_resource_report": false, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "project_dir": "/Users/gsokolov/My Drive (lebbylovejoy@gmail.com)/dbt_octafx", "enable_legacy_logger": false, "require_resource_names_without_spaces": false, "quiet": false, "send_anonymous_usage_stats": true, "exclude_resource_types": [], "source_freshness_run_project_hooks": false, "use_colors": true, "log_level_file": "debug", "exclude": [], "log_format_file": "debug", "log_file_max_bytes": 10485760, "resource_types": [], "log_path": "/Users/gsokolov/My Drive (lebbylovejoy@gmail.com)/dbt_octafx/logs", "log_format": "default", "introspect": true, "which": "build", "show": false, "export_saved_queries": false, "strict_mode": false, "populate_cache": true, "static_parser": true, "select": ["trading_dynamics_rolling_aggregates"], "defer": false, "invocation_command": "dbt ", "printer_width": 80, "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "/Users/gsokolov/.dbt", "print": true, "use_colors_file": true, "version_check": true, "write_json": true, "vars": {}, "empty": false, "cache_selected_only": false, "include_saved_query": false, "partial_parse_file_diff": true, "favor_state": false}}