{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-04-26T03:38:11.786600Z", "invocation_id": "cb329cc1-f6c7-4584-8d35-2c639e57bb51", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:06.923270Z", "completed_at": "2024-04-26T03:38:06.997431Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.002541Z", "completed_at": "2024-04-26T03:38:07.860591Z"}], "thread_id": "Thread-70 (worker)", "execution_time": 0.9478793144226074, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "91017e1f-4bb9-4741-944e-5c7190e0fe1e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_bloomreach_events", "compiled": true, "compiled_code": "\n\nselect\n    c.type,\n    c.internal_customer_id,\n    c.ingest_timestamp,\n    c.timestamp,\n    properties.action_type,\n    properties.campaign_trigger,\n    properties.language,\n    properties.platform,\n    properties.campaign_name,\n    properties.action_id,\n    properties.campaign_policy,\n    -- properties.subject,\n    properties.action_name,\n    properties.recipient,\n    -- properties.message,\n    properties.sent_timestamp,\n    properties.consent_category,\n    properties.campaign_id,\n    properties.status,\n    properties.integration_id,\n    properties.message_id,\n    properties.integration_name,\n    properties.utm_campaign,\n    properties.utm_medium,\n    properties.utm_source,\n    properties.code,\n    properties.message_type,\n    properties.sender,\n    properties.sending_ip,\n    properties.country,\n    properties.city,\n    properties.ip,\n    properties.state,\n    properties.longitude,\n    properties.status_code,\n    properties.error,\n    properties.event_type,\n    properties.symbol,\n    properties.redirect_to_screen,\n    properties.template_name,\n    properties.title,\n    properties.attempts,\n    properties.delta_time,\n    properties.os,\n    properties.location,\n    properties.device,\n    properties.action_url,\n    safe_cast(c.user_id as numeric) as user_id\nfrom `analytics-147612`.`bloomreach_raw`.`campaign` as c\nwhere\n    timestamp_trunc(c.timestamp, day) >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:06.921112Z", "completed_at": "2024-04-26T03:38:07.012303Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.015327Z", "completed_at": "2024-04-26T03:38:07.896714Z"}], "thread_id": "Thread-69 (worker)", "execution_time": 0.9851157665252686, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "2f77dbe5-16c3-4f9e-903b-cfd7ae170c22", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_af_events", "compiled": true, "compiled_code": "SELECT\n    af.id,\n    af.appsflyer_id\n    -- , af_id.user_id\n    , media_source\n    , af_channel\n    , campaign\n    , country_code\n    , af.ip\n    , af.platform\n    , af.device_type\n    , af.os_version\n    , af.app_version\n    , af.sdk_version\n    , af.app_id\n    , af.app_name\n    , af.bundle_id\n    , af.event_name\n    , af.event_value\n    , af.device_model\n    , af.device_brand\n    , af.event_type\n    , af.event_time_dt\n    , af.install_time_dt\n    , af.store_reinstall\n    , af.install_app_store\nFROM `analytics-147612`.`wh_raw`.`mobile_appsflyer` AS af\nWHERE af.event_time_dt >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_af_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:06.919448Z", "completed_at": "2024-04-26T03:38:07.013369Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.021723Z", "completed_at": "2024-04-26T03:38:07.941532Z"}], "thread_id": "Thread-68 (worker)", "execution_time": 1.035893440246582, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "9810178a-38f3-46bd-9965-dc5f2829f749", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.eligible_users", "compiled": true, "compiled_code": "with u as (\n      select distinct user_id\n      from wh_raw.users\n      where EXTRACT(year from registered_dt) = 2024\n  ),\n  \n  b as (\n      select distinct SAFE_CAST(user_id as int64) as user_id\n      from bloomreach_raw.campaign where\n          DATE(timestamp) between '2024-01-01' and DATE(CURRENT_TIMESTAMP)\n          and SAFE_CAST(user_id as int64) in (select user_id from u)\n          and properties.action_type = 'mobile notification'\n          and properties.status = 'delivered'\n  )\n      SELECT * FROM b", "relation_name": "`analytics-147612`.`dev_gsokolov`.`eligible_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:06.924514Z", "completed_at": "2024-04-26T03:38:07.026112Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.151062Z", "completed_at": "2024-04-26T03:38:07.943652Z"}], "thread_id": "Thread-71 (worker)", "execution_time": 1.0339701175689697, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "223692d0-3895-4fe0-a456-06a9156af365", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_users", "compiled": true, "compiled_code": "select\n    user_id,\n    country_code,\n    registered_dt\nfrom\n    `analytics-147612`.`wh_raw`.`users`\nwhere registered_dt >= '2024-01-01'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:06.933908Z", "completed_at": "2024-04-26T03:38:07.021175Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.147022Z", "completed_at": "2024-04-26T03:38:08.226689Z"}], "thread_id": "Thread-72 (worker)", "execution_time": 1.3119878768920898, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "67fd5d44-bf1d-4485-a27a-bd9da67acb38", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.uninstalls", "compiled": true, "compiled_code": "with uninstall_events as (\n    select * from `analytics-147612`.`dev_gsokolov`.`appsflyer_uninstall_events_report`\n),\n\nusers as (\n    select * from `analytics-147612`.`dev_gsokolov`.`users_cids_all`\n),\n\njoined_data as (\n    select u.*, e.appsflyer_id\n    from users u\n    join uninstall_events e\n    on u.client_id = e.appsflyer_id\n)\n\nselect *\nfrom joined_data", "relation_name": "`analytics-147612`.`dev_gsokolov`.`uninstalls`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:07.865646Z", "completed_at": "2024-04-26T03:38:07.880771Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.881675Z", "completed_at": "2024-04-26T03:38:08.775156Z"}], "thread_id": "Thread-74 (worker)", "execution_time": 0.9115302562713623, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "fe218da3-b06e-49b3-9d80-fa41390a0a04", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.stg_pushes", "compiled": true, "compiled_code": "select ue.*\nfrom `analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events` as ue\nwhere action_type = 'mobile notification'\nand status in ('delivered', 'clicked', 'failed')", "relation_name": "`analytics-147612`.`dev_gsokolov`.`stg_pushes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:07.955746Z", "completed_at": "2024-04-26T03:38:07.970934Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.971824Z", "completed_at": "2024-04-26T03:38:09.043212Z"}], "thread_id": "Thread-70 (worker)", "execution_time": 1.0893244743347168, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "c4970a0c-4cba-4374-bc3d-9989743235f5", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_bloomreach_events_enhanced", "compiled": true, "compiled_code": "select\n    c.*,\n    u.country_code,\n    u.registered_dt\nfrom `analytics-147612`.`dev_gsokolov`.`stg_bloomreach_events` as c\ninner join `analytics-147612`.`dev_gsokolov`.`stg_users` as u\n    on\n        safe_cast(c.user_id as integer) = u.user_id\n        and timestamp_trunc(\n            c.timestamp, day\n        ) between u.registered_dt and u.registered_dt\n        + interval 28 day", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:08.780313Z", "completed_at": "2024-04-26T03:38:08.794302Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:08.795192Z", "completed_at": "2024-04-26T03:38:09.739430Z"}], "thread_id": "Thread-69 (worker)", "execution_time": 0.9609355926513672, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "604b1d69-0fad-4998-acbd-76f91f6062c6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_notreg_pushes", "compiled": true, "compiled_code": "select *\nfrom `analytics-147612`.`dev_gsokolov`.`stg_pushes`\nwhere status = 'failed' and error = 'NotRegistered'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_notreg_pushes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:06.917629Z", "completed_at": "2024-04-26T03:38:07.012836Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:07.018362Z", "completed_at": "2024-04-26T03:38:09.863308Z"}], "thread_id": "Thread-67 (worker)", "execution_time": 2.9538209438323975, "adapter_response": {"_message": "CREATE TABLE (257.0 rows, 10.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 257, "bytes_processed": 11188, "bytes_billed": 20971520, "location": "EU", "project_id": "analytics-147612", "job_id": "9a354a3d-4b7b-45cb-86cd-f04a71903282", "slot_ms": 2472}, "message": "CREATE TABLE (257.0 rows, 10.9 KiB processed)", "failures": null, "unique_id": "model.dbt_octafx.countries", "compiled": true, "compiled_code": "\n\nSELECT\n    c.country,\n    c.code,\n    ct.tier,\n    concat(\"Tier \", ct.tier_id) as tier_name\nFROM `analytics-147612`.`wh_raw`.`countries` AS c\nLEFT JOIN\n    `analytics-147612`.`wh_raw`.`countries_tiers` AS ct\n    ON c.country = ct.country", "relation_name": "`analytics-147612`.`dev_gsokolov`.`countries`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:09.050444Z", "completed_at": "2024-04-26T03:38:09.067856Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:09.069719Z", "completed_at": "2024-04-26T03:38:10.013618Z"}], "thread_id": "Thread-71 (worker)", "execution_time": 0.9662978649139404, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "5582922f-274a-4089-8c0e-172cf37738df", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_af_id", "compiled": true, "compiled_code": "SELECT\n    cast(user_id as numeric) as user_id\n    , client_id AS appsflyer_id\n    , af.install_time_dt\nFROM (\n    SELECT\n        *\n        , ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY dt DESC) AS row_num\n    FROM `analytics-147612`.`wh_raw`.`users_cids_all`\n    WHERE user_id IN (SELECT DISTINCT user_id FROM `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`)\n) AS s\n    INNER JOIN `analytics-147612`.`wh_raw`.`mobile_appsflyer` AS af\n        ON s.client_id = af.appsflyer_id\n            AND af.event_time_dt >= '2024-01-01'\nWHERE s.row_num = 1", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_af_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:09.053862Z", "completed_at": "2024-04-26T03:38:09.068386Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:09.072742Z", "completed_at": "2024-04-26T03:38:10.018271Z"}], "thread_id": "Thread-73 (worker)", "execution_time": 0.9704880714416504, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "9a4cd526-a4c0-43be-aaa0-9ccadb0c9a31", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_pushes", "compiled": true, "compiled_code": "SELECT \n      *,\n      CASE \n        WHEN event_order = 1 THEN timestamp \n        ELSE NULL \n      END AS first_event \n    FROM (\n      SELECT \n        *,\n        ROW_NUMBER() OVER (\n          PARTITION BY user_id\n          ORDER BY timestamp\n        ) AS event_order \n      FROM `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`\n      WHERE safe_cast(user_id as int64) IN (\n        SELECT user_id \n        FROM `analytics-147612`.`dev_gsokolov`.`eligible_users`\n      )\n      AND action_type = 'mobile notification'\n      AND date(timestamp) BETWEEN '2024-01-01' AND date(current_timestamp)\n      AND status IN ('delivered', 'failed')\n    )", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_pushes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:09.744566Z", "completed_at": "2024-04-26T03:38:09.761287Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:09.762491Z", "completed_at": "2024-04-26T03:38:10.693749Z"}], "thread_id": "Thread-74 (worker)", "execution_time": 0.9512522220611572, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "e950f075-9fed-48d2-85c4-0f93b61ebeeb", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_notreg_user_id", "compiled": true, "compiled_code": "with\nfirst_not_registered as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp\n    from `analytics-147612`.`dev_gsokolov`.`int_notreg_pushes`\n    where error = \"NotRegistered\"\n    group by user_id\n)\n\nselect distinct\n    uep.user_id,\n    fnr.first_error_timestamp\nfrom `analytics-147612`.`dev_gsokolov`.`int_notreg_pushes` as uep\ninner join first_not_registered as fnr on uep.user_id = fnr.user_id\ngroup by 1, 2", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:10.028695Z", "completed_at": "2024-04-26T03:38:10.333337Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:10.334536Z", "completed_at": "2024-04-26T03:38:11.473601Z"}], "thread_id": "Thread-72 (worker)", "execution_time": 1.4508121013641357, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "4c1c3a73-fe6b-4faf-b283-38924939fead", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.starred", "compiled": true, "compiled_code": "SELECT\n    e.*,\ni.`appsflyer_id`,\n  i.`install_time_dt`,\n  i.user_id AS af_user_id\nFROM\n    `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced` AS e\nLEFT JOIN `analytics-147612`.`dev_gsokolov`.`int_af_id` AS i ON e.user_id = i.user_id\nWHERE\n    e.action_type = 'mobile notification'", "relation_name": "`analytics-147612`.`dev_gsokolov`.`starred`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:10.701468Z", "completed_at": "2024-04-26T03:38:10.720826Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:10.722722Z", "completed_at": "2024-04-26T03:38:11.698529Z"}], "thread_id": "Thread-68 (worker)", "execution_time": 1.0003139972686768, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "4de62cef-b340-4774-957e-756b521dde72", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_events_enum", "compiled": true, "compiled_code": "with\nevents as (\n    select\n        *,\n        row_number() over (\n            partition by user_id order by cast(timestamp as datetime)\n        ) as event_number\n    from `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`\n    where\n        user_id in (select distinct user_id from `analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`)\n        and status in ('delivered', 'clicked', 'failed')\n),\n\nfirst_not_registered as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp,\n        min(event_number) as first_error_event_number\n    from events\n    where error = \"NotRegistered\"\n    group by user_id\n)\n\nselect\n    cast(e.user_id as numeric) as user_id,\n    country_code,\n    registered_dt,\n    status,\n    campaign_id,\n    consent_category,\n    sent_timestamp,\n    action_name,\n    action_id,\n    campaign_name,\n    platform,\n    campaign_trigger,\n    action_type,\n    ingest_timestamp,\n    timestamp,\n    type,\n    fnr.first_error_timestamp,\n    cast(fnr.first_error_event_number as numeric) as first_error_event_number\nfrom events as e\nleft join first_not_registered as fnr on e.user_id = fnr.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_events_enum`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:10.025251Z", "completed_at": "2024-04-26T03:38:10.077160Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:10.078243Z", "completed_at": "2024-04-26T03:38:11.740716Z"}], "thread_id": "Thread-70 (worker)", "execution_time": 1.718519926071167, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "2185a5f6-c608-4250-8078-9d173aca2025", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_users_af", "compiled": true, "compiled_code": "select\n    u.*,\n    af.appsflyer_id,\n    af.install_time_dt\nfrom `analytics-147612`.`dev_gsokolov`.`stg_users` as u\ninner join\n    `analytics-147612`.`dev_gsokolov`.`int_af_id` as af\n    on u.user_id = af.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_users_af`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T03:38:10.704594Z", "completed_at": "2024-04-26T03:38:10.721332Z"}, {"name": "execute", "started_at": "2024-04-26T03:38:10.725660Z", "completed_at": "2024-04-26T03:38:11.779349Z"}], "thread_id": "Thread-67 (worker)", "execution_time": 1.0805368423461914, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "analytics-147612", "job_id": "d9fdb78c-3c41-499b-a417-998cf197eee1", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_octafx.int_pushes_enum", "compiled": true, "compiled_code": "with\n    pushes as (\n        select\n            *,\n            row_number() over (\n                partition by user_id order by cast(timestamp as datetime)\n            ) as event_number\n        from `analytics-147612`.`dev_gsokolov`.`int_bloomreach_events_enhanced`\n        where user_id in (select distinct user_id from `analytics-147612`.`dev_gsokolov`.`int_notreg_user_id`)\n        and (action_type = 'mobile notification' and status in ('delivered', 'clicked', 'failed'))\n    ),\n    first_not_registered as (\n        select\n            user_id,\n            min(cast(timestamp as datetime)) as first_error_timestamp,\n            min(event_number) as first_error_event_number\n        from pushes\n        where error = \"NotRegistered\"\n        group by user_id\n    ),\n    first_error_event as (\n    select\n        user_id,\n        min(cast(timestamp as datetime)) as first_error_timestamp\n    from\n        pushes\n    where\n        error = 'NotRegistered'\n    group by\n        user_id\n),\nnext_delivered_event as (\n    select\n        e.user_id,\n        min(cast(e.timestamp as datetime)) as next_delivered_timestamp\n    from\n        pushes e\n    join\n        first_error_event fee on e.user_id = fee.user_id\n    where\n        e.status = 'delivered' and cast(e.timestamp as datetime) > fee.first_error_timestamp\n    group by\n        e.user_id\n)\nselect\n    fee.user_id,\n    fee.first_error_timestamp,\n    nde.next_delivered_timestamp,\n    date_diff(nde.next_delivered_timestamp, fee.first_error_timestamp, second) as time_difference_in_seconds\nfrom\n    first_error_event fee\nleft join\n    next_delivered_event nde on fee.user_id = nde.user_id", "relation_name": "`analytics-147612`.`dev_gsokolov`.`int_pushes_enum`"}], "elapsed_time": 5.704667329788208, "args": {"populate_cache": true, "macro_debugging": false, "favor_state": false, "select": ["push_problem"], "enable_legacy_logger": false, "profiles_dir": "/usr/src/dbt-server-shared/.dbt", "resource_types": [], "include_saved_query": false, "log_level": "info", "printer_width": 80, "write_json": true, "profile": "user", "project_dir": "/usr/src/develop/user-276034/environment-306662/repository-218601", "log_path": "/usr/src/dbt-server-shared/working_dir/6cce9cc2-bf03-4414-84f1-4a7650cedef5", "show": false, "log_level_file": "debug", "cache_selected_only": false, "print": true, "partial_parse_file_diff": true, "log_file_max_bytes": 0, "show_resource_report": false, "use_colors": true, "strict_mode": false, "log_format": "json", "log_format_file": "json", "use_colors_file": true, "which": "build", "exclude": [], "send_anonymous_usage_stats": true, "invocation_command": "dbt -A dbt_worker.app worker --loglevel=DEBUG --concurrency=2 --max-memory-per-child=500000", "quiet": false, "static_parser": true, "vars": {}, "indirect_selection": "eager", "introspect": true, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "defer": false}}