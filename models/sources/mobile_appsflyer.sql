{{ config(materialized="view") }}
with
    source as (select * from {{ source("wh_raw", "mobile_appsflyer") }}),
    renamed as (
        select
            id,
            attributed_touch_type,
            attributed_touch_time,
            media_source,
            is_retargeting,
            retargeting_conversion_type,
            af_channel,
            af_keywords,
            campaign,
            af_c_id,
            af_adset,
            af_adset_id,
            af_ad,
            af_ad_id,
            af_ad_type,
            af_siteid,
            af_sub1,
            af_sub2,
            af_sub3,
            af_sub4,
            af_sub5,
            http_referrer,
            original_url,
            user_agent,
            af_cost_model,
            af_cost_value,
            af_cost_currency,
            contributor1_af_prt,
            contributor1_media_source,
            contributor1_campaign,
            contributor1_touch_type,
            contributor1_touch_time,
            contributor2_af_prt,
            contributor2_media_source,
            contributor2_campaign,
            contributor2_touch_type,
            contributor2_touch_time,
            contributor3_af_prt,
            contributor3_media_source,
            contributor3_campaign,
            contributor3_touch_type,
            contributor3_touch_time,
            country_code,
            ip,
            region,
            state,
            city,
            wifi,
            operator,
            carrier,
            language,
            appsflyer_id,
            advertising_id,
            idfa,
            android_id,
            customer_user_id,
            imei,
            idfv,
            platform,
            device_type,
            os_version,
            app_version,
            sdk_version,
            app_id,
            app_name,
            bundle_id,
            af_attribution_lookback,
            event_name,
            event_value,
            event_revenue,
            event_revenue_usd,
            event_revenue_currency,
            postal_code,
            dma,
            af_reengagement_window,
            event_source,
            is_primary_attribution,
            af_sub_siteid,
            download_time,
            device_model,
            device_brand,
            event_type,
            agency,
            attribution_type,
            event_time_dt,
            install_time_dt,
            insert_id,
            store_reinstall,
            install_app_store,
            engagement_type,
            af_event_type
        from source
    )
select *
from renamed
where extract(year from event_time_dt) = extract(year from current_date())
